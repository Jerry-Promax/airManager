<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.airticketmanager.mapper.AdminOrderMapper">

    <resultMap id="OrderResultMap" type="com.example.airticketmanager.entity.Order">
        <!-- 主表orders的字段映射 -->
        <id property="orderId" column="order_id"/>
        <result property="userId" column="user_id"/>
        <result property="flightId" column="flight_id"/>
        <result property="orderStatus" column="order_status"/>
        <result property="seatNumber" column="seat_number"/>
        <result property="orderTime" column="order_time"/>
        <result property="price" column="price"/>

        <!-- 关联User对象 -->
<!--        <association property="user" javaType="com.example.airticketmanager.entity.User">-->
<!--&lt;!&ndash;            <id property="userId" column="user_id"/>&ndash;&gt;-->
<!--            <result property="name" column="uname"/>-->
<!--            <result property="idCard" column="uid_card"/>-->
<!--            <result property="tel" column="utel"/>-->
<!--        </association>-->

<!--        &lt;!&ndash; 关联Flight对象 &ndash;&gt;-->
        <association property="flight" javaType="com.example.airticketmanager.entity.Flight" column="flight_id" select="getFlight">
        </association>
    </resultMap>

    <select id="getFlight" resultType="com.example.airticketmanager.entity.Flight">
        select flight_number from flights where flight_id = #{flight_id}
    </select>

    <!-- 分页查询订单 -->
    <select id="selectOrdersByPage" resultMap="OrderResultMap">
        SELECT
            *
        FROM orders
            LIMIT #{limit} OFFSET #{offset}
    </select>
</mapper>